{"version":3,"sources":["../src/d3-state-handler.js"],"names":[],"mappings":";;;;;AAGA,QAAI,CAAC,MAAM,CAAC,MAAM,EAAE;AAChB,cAAM,CAAC,cAAc,CAAC,MAAM,EAAE,QAAQ,EAAE;AACpC,sBAAU,EAAE,KAAK;AACjB,wBAAY,EAAE,IAAI;AAClB,oBAAQ,EAAE,IAAI;AACd,iBAAK,EAAE,eAAS,MAAM,EAAE;AACpB,4BAAY,CAAC;AACb,oBAAI,MAAM,KAAK,SAAS,IAAI,MAAM,KAAK,IAAI,EAAE;AACzC,0BAAM,IAAI,SAAS,CAAC,yCAAyC,CAAC,CAAC;iBAClE;;AAED,oBAAI,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;AACxB,qBAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACvC,wBAAI,UAAU,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;AAC9B,wBAAI,UAAU,KAAK,SAAS,IAAI,UAAU,KAAK,IAAI,EAAE;AACjD,iCAAS;qBACZ;AACD,8BAAU,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC;;AAEhC,wBAAI,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AACxC,yBAAK,IAAI,SAAS,GAAG,CAAC,EAAE,GAAG,GAAG,SAAS,CAAC,MAAM,EAAE,SAAS,GAAG,GAAG,EAAE,SAAS,EAAE,EAAE;AAC1E,4BAAI,OAAO,GAAG,SAAS,CAAC,SAAS,CAAC,CAAC;AACnC,4BAAI,IAAI,GAAG,MAAM,CAAC,wBAAwB,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;AAChE,4BAAI,IAAI,KAAK,SAAS,IAAI,IAAI,CAAC,UAAU,EAAE;AACvC,8BAAE,CAAC,OAAO,CAAC,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC;yBACrC;qBACJ;iBACJ;AACD,uBAAO,EAAE,CAAC;aACb;SACJ,CAAC,CAAC;KACN;;;AAGD,aAAS,kBAAkB,CAAC,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE;AACvD,aAAI,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;AAC/C,gBAAI,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,UAAU,EAAE,OAAO,CAAC,CAAC;SACrD;AACD,eAAO,CAAC,CAAC,CAAC;KACb;;;AAGD,aAAS,UAAU,CAAC,OAAO,EAAE;AACzB,oBAAY,CAAC;AACb,YAAI,CAAC,IAAI,GAAG,iBAAiB,CAAC;AAC9B,YAAI,CAAC,OAAO,GAAG,OAAO,IAAI,wCAAwC,CAAC;AACnE,YAAI,CAAC,KAAK,GAAG,AAAC,IAAI,KAAK,EAAE,CAAE,KAAK,CAAC;KACpC;AACD,cAAU,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;AACtD,cAAU,CAAC,SAAS,CAAC,WAAW,GAAG,UAAU,CAAC;;AAE9C,aAAS,UAAU,CAAC,OAAO,EAAE;AACzB,oBAAY,CAAC;AACb,YAAI,CAAC,IAAI,GAAG,iBAAiB,CAAC;AAC9B,YAAI,CAAC,OAAO,GAAG,OAAO,IAAI,qCAAqC,CAAC;AAChE,YAAI,CAAC,KAAK,GAAG,AAAC,IAAI,KAAK,EAAE,CAAE,KAAK,CAAC;KACpC;AACD,cAAU,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;AACtD,cAAU,CAAC,SAAS,CAAC,WAAW,GAAG,UAAU,CAAC;;AAE9C,QAAM,YAAY,GAAG,SAAS,YAAY,CAAC,IAAI,EAAE;AAC7C,oBAAY,CAAC;;;;AACb,YAAI,YAAY,GAAG,CAAC,CAAC;AACrB,YAAI,MAAM,GAAG,EAAE,CAAC;AAChB,YAAI,OAAO,GAAG,IAAI,IAAI;AACd,gBAAI,EAAE,KAAK;SACd,CAAC;AACN,YAAI,IAAI,GAAG,OAAO,CAAC,IAAI,IAAI,EAAE,CAAC;AAC9B,YAAI,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,EAAE,CAAC;;AAExC,YAAI,YAAY,GAAG,SAAf,YAAY,GAAS;AACrB,kBAAM,CAAC,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,EAAC,IAAI,CAAC,CAAC;AAC9C,mBAAO,MAAM,CAAC,YAAY,CAAC,CAAC;SAC/B,CAAC;;AAEF,YAAI,KAAK,GAAG,SAAR,KAAK,GAAS;AACd,kBAAM,CAAC,YAAY,CAAC,CAAC,IAAI,GAAG,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACnE,kBAAM,CAAC,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC;SAClD,CAAC;;AAEF,YAAI,GAAG,GAAG,SAAN,GAAG,CAAI,KAAK,EAAK;AACjB,gBAAI,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC;AAC1B,iBAAK,CAAC,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAC,IAAI,CAAC,CAAC;AACpC,iBAAK,CAAC,SAAS,CAAC,GAAG,KAAK,CAAC;AACzB,gBAAI,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;AAC5C,gBAAI,OAAO,KAAK,CAAC,MAAM,KAAK,UAAU,EAAE,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;AAC1F,gBAAI,OAAO,KAAK,CAAC,MAAM,KAAK,UAAU,EAAE,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;;AAEpE,kBAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AACnB,yBAAY;SACf,CAAC;;AAEF,YAAI,MAAM,GAAG,SAAT,MAAM,CAAI,IAAI,EAAK;AACnB,gBAAI,KAAK,GAAG,kBAAkB,CAAC,MAAM,EAAC,IAAI,EAAC,MAAM,CAAC,CAAC;;AAEnD,gBAAI,KAAK,GAAG,CAAC,CAAC,EAAE;AACZ,qBAAK,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;aAC1B;;AAED,yBAAY;SACf,CAAC;;AAEF,YAAI,MAAM,GAAG,SAAT,MAAM,CAAI,IAAI,EAAK;AACnB,gBAAI,KAAK,GAAG,kBAAkB,CAAC,MAAM,EAAC,IAAI,EAAC,MAAM,CAAC,CAAC;AACnD,gBAAI,KAAK,GAAG,CAAC,CAAC,EAAE;AACZ,oBAAI;AACA,gCAAY,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACrC,CAAC,OAAM,CAAC,EAAE;AACP,wBAAI,CAAC,CAAC,CAAC,IAAI,KAAK,WAAW,EAAE,MAAM,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC;iBACnD;;AAED,4BAAY,GAAG,KAAK,CAAC;AACrB,oBAAI;AACA,gCAAY,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACpC,CAAC,OAAM,CAAC,EAAE;AACP,wBAAI,CAAC,CAAC,CAAC,IAAI,KAAK,WAAW,EAAE,MAAM,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC;iBACnD;;AAED,4BAAY,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;aACnC,MAAM;AACH,sBAAM,IAAI,KAAK,YAAU,IAAI,qBAAkB,CAAA;aAClD;SACJ,CAAC;;AAEF,YAAI,IAAI,GAAG,SAAP,IAAI,GAAS;AACb,wBAAY,CAAC;;AAEb,gBAAI,OAAO,MAAM,CAAC,YAAY,CAAC,CAAC,OAAO,KAAK,WAAW,EAAE,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAC,MAAM,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;;AAG1H,gBAAI,YAAY,GAAG,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE;AAClC,4BAAY,IAAI,CAAC,CAAC;aACrB,MAAM,IAAI,OAAO,CAAC,IAAI,EAAE;AACrB,4BAAY,GAAG,CAAC,CAAC;aACpB,MAAM;AACH,sBAAM,IAAI,UAAU,EAAE,CAAC;aAC1B;;;AAGD,gBAAI,OAAO,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,KAAK,WAAW,EAAE,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;;AAGxH,gBAAI,OAAO,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,KAAK,WAAW,EAAE,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AACxH,kBAAM,CAAC,YAAY,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC;AACjC,yBAAY;SACf,CAAC;;AAEF,YAAI,IAAI,GAAG,SAAP,IAAI,GAAS;AACb,wBAAY,CAAC;;;AAGb,gBAAI,OAAO,MAAM,CAAC,YAAY,CAAC,CAAC,OAAO,KAAK,WAAW,EAAE,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAC,MAAM,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;;AAG1H,gBAAI,YAAY,GAAG,CAAC,IAAI,CAAC,EAAE;AACvB,4BAAY,IAAI,CAAC,CAAC;aACrB,MAAM,IAAI,OAAO,CAAC,IAAI,EAAE;AACrB,4BAAY,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;aACpC,MAAM;AACH,sBAAM,IAAI,UAAU,EAAE,CAAC;aAC1B;;;AAGD,gBAAI,OAAO,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,KAAK,WAAW,EAAE,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;;AAGxH,gBAAI,OAAO,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,KAAK,WAAW,EAAE,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AACxH,kBAAM,CAAC,YAAY,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC;AACjC,yBAAY;SACf,CAAC;;AAEF,YAAI,MAAM,GAAG,SAAT,MAAM,GAAS;AACf,wBAAY,CAAC,MAAM,EAAE,CAAA;SACxB,CAAC;;AAEF,eAAO;AACH,gBAAI,EAAE,IAAI;AACV,eAAG,EAAE,GAAG;AACR,wBAAY,EAAE,YAAY;AAC1B,gBAAI,EAAE,IAAI;AACV,kBAAM,EAAE,MAAM;AACd,kBAAM,EAAE,MAAM;AACd,kBAAM,EAAE,MAAM;AACd,iBAAK,EAAE,KAAK;SACf,CAAA;KACJ,CAAC;;qBAEa,YAAY","file":"d3-state-handler.js","sourcesContent":["import _ from 'lodash';\n\n// polyfill object assign\nif (!Object.assign) {\n    Object.defineProperty(Object, 'assign', {\n        enumerable: false,\n        configurable: true,\n        writable: true,\n        value: function(target) {\n            'use strict';\n            if (target === undefined || target === null) {\n                throw new TypeError('Cannot convert first argument to object');\n            }\n\n            var to = Object(target);\n            for (var i = 1; i < arguments.length; i++) {\n                var nextSource = arguments[i];\n                if (nextSource === undefined || nextSource === null) {\n                    continue;\n                }\n                nextSource = Object(nextSource);\n\n                var keysArray = Object.keys(nextSource);\n                for (var nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {\n                    var nextKey = keysArray[nextIndex];\n                    var desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);\n                    if (desc !== undefined && desc.enumerable) {\n                        to[nextKey] = nextSource[nextKey];\n                    }\n                }\n            }\n            return to;\n        }\n    });\n}\n\n// Stolen from http://stackoverflow.com/a/8668283\nfunction arrayObjectIndexOf(myArray, searchTerm, property) {\n    for(var i = 0, len = myArray.length; i < len; i++) {\n        if (myArray[i][property] === searchTerm) return i;\n    }\n    return -1;\n}\n\n// Error handling\nfunction FinalState(message) {\n    \"use strict\";\n    this.name = 'FinalStateError';\n    this.message = message || \"There are no more states to advance to\";\n    this.stack = (new Error()).stack;\n}\nFinalState.prototype = Object.create(Error.prototype);\nFinalState.prototype.constructor = FinalState;\n\nfunction FirstState(message) {\n    \"use strict\";\n    this.name = 'FirstStateError';\n    this.message = message || \"There are no states before this one\";\n    this.stack = (new Error()).stack;\n}\nFirstState.prototype = Object.create(Error.prototype);\nFirstState.prototype.constructor = FirstState;\n\nconst StateHandler = function StateHandler(opts) {\n    \"use strict\";\n    let currentIndex = 0;\n    let states = [];\n    let options = opts || {\n            loop: false // specifies whether states should loop from end - beginning and vice versa\n        };\n    let data = options.data || {};\n    let jumpState = options.jumpState || {};\n\n    let currentState = () => {\n        Object.assign(states[currentIndex].data,data);\n        return states[currentIndex];\n    };\n\n    let start = () => {\n        states[currentIndex].data = states[currentIndex].render.call(data);\n        Object.assign(data, states[currentIndex].data);\n    };\n\n    let add = (state) => {\n        let index = states.length;\n        state.data = Object.assign({},data);\n        state['__index'] = index;\n        if (!state.name) state.name = String(index);\n        if (typeof state.render !== 'function') throw new Error('States require a render method');\n        if (typeof state.resize !== 'function') state.resize = state.render;\n\n        states.push(state);\n        return this;\n    };\n\n    let remove = (name) => {\n        let index = arrayObjectIndexOf(states,name,'name');\n\n        if (index > -1) {\n            array.splice(index, 1);\n        }\n\n        return this;\n    };\n\n    let jumpTo = (name) => {\n        let index = arrayObjectIndexOf(states,name,'name');\n        if (index > -1) {\n            try {\n                currentState().jumpOut.call(data);\n            } catch(e) {\n                if (!e.name === 'TypeError') throw new Error(e);\n            }\n            //if (!_.isEqual(data,jumpState)) throw new Error('jumpOut function did not match general state spec');\n            currentIndex = index;\n            try {\n                currentState().jumpIn.call(data);\n            } catch(e) {\n                if (!e.name === 'TypeError') throw new Error(e);\n            }\n            //if (!_.isEqual(data,jumpState)) throw new Error('jumpIn function did not match general state spec');\n            currentState().render.call(data)\n        } else {\n            throw new Error(`State ${name} does not exist`)\n        }\n    };\n\n    let next = () => {\n        \"use strict\";\n        // Call nextOut on the current state if it exists\n        if (typeof states[currentIndex].nextOut !== 'undefined') data = Object.assign({},states[currentIndex].nextOut.call(data));\n\n        // Set the current state to the next index. Loop if specified.\n        if (currentIndex + 1 < states.length) {\n            currentIndex += 1;\n        } else if (options.loop) {\n            currentIndex = 0;\n        } else {\n            throw new FinalState();\n        }\n\n        // Call nextIn on the new current state\n        if (typeof states[currentIndex].nextIn !== 'undefined') data = Object.assign({},states[currentIndex].nextIn.call(data));\n\n        // Call render on the new current state\n        if (typeof states[currentIndex].render !== 'undefined') data = Object.assign({},states[currentIndex].render.call(data));\n        states[currentIndex].data = data;\n        return this;\n    };\n\n    let prev = () => {\n        \"use strict\";\n        // Call prevOut on the current state if it exists\n\n        if (typeof states[currentIndex].prevOut !== 'undefined') data = Object.assign({},states[currentIndex].prevOut.call(data));\n\n        // Set the current state to the previous index. Loop if specified.\n        if (currentIndex - 1 >= 0) {\n            currentIndex -= 1;\n        } else if (options.loop) {\n            currentIndex = states.length - 1;\n        } else {\n            throw new FirstState();\n        }\n\n        // Call prevIn on the new current state\n        if (typeof states[currentIndex].prevIn !== 'undefined') data = Object.assign({},states[currentIndex].prevIn.call(data));\n\n        // Call render on new current state;\n        if (typeof states[currentIndex].render !== 'undefined') data = Object.assign({},states[currentIndex].render.call(data));\n        states[currentIndex].data = data;\n        return this;\n    };\n\n    let resize = () => {\n        currentState.resize()\n    };\n\n    return {\n        next: next,\n        add: add,\n        currentState: currentState,\n        prev: prev,\n        remove: remove,\n        resize: resize,\n        jumpTo: jumpTo,\n        start: start\n    }\n};\n\nexport default StateHandler;"]}